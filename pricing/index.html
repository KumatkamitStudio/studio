<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kumatkamit.Studio - Price Calculator & Invoice</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React, ReactDOM, & Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Fonts: Plus Jakarta Sans -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            letter-spacing: -0.02em;
        }
        @media print {
            .no-print { display: none !important; }
            .print-only { display: block !important; }
            body { background: white; padding: 0; margin: 0; }
            .shadow-2xl { box-shadow: none !important; }
        }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #059669; border-radius: 10px; }
        
        .package-card-active {
            border-color: #10b981;
            background-color: #f0fdf4;
            box-shadow: 0 10px 15px -3px rgba(16, 185, 129, 0.1);
            transform: translateY(-4px);
        }

        input::placeholder {
            color: #94a3b8;
            font-weight: 400;
        }

        .shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // --- DATA HARGA ---
        const PACKAGES = [
            { 
                id: 'starter', 
                name: 'Starter', 
                target: 'UMKM & Influencer Pemula', 
                features: [
                    { label: 'Logo Basic', icon: 'M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z' },
                    { label: '8-12 Video Reels', icon: 'M15 10l4.55-2.27A1 1 0 0121 8.61v6.78a1 1 0 01-1.45.89L15 14v2a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h8a2 2 0 012 2v2z' },
                    { label: 'Poster/Banner', icon: 'M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z' }
                ],
                price: [2500000, 3000000], 
                color: 'emerald-400' 
            },
            { 
                id: 'pro', 
                name: 'Pro', 
                target: 'Usaha Menengah', 
                features: [
                    { label: 'Upgrade Logo Design', icon: 'M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z' },
                    { label: '12-20 Video Reels', icon: 'M15 10l4.55-2.27A1 1 0 0121 8.61v6.78a1 1 0 01-1.45.89L15 14v2a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h8a2 2 0 012 2v2z' },
                    { label: 'Mini Branding Kit', icon: 'M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z' },
                    { label: 'Feed Sosmed Layout', icon: 'M4 5a1 1 0 011-1h14a1 1 0 011 1v14a1 1 0 01-1 1H5a1 1 0 01-1-1V5z' }
                ],
                price: [6000000, 10000000], 
                color: 'emerald-600',
                popular: true
            },
            { 
                id: 'suite', 
                name: 'Suite', 
                target: 'Corporate System', 
                features: [
                    { label: 'Brand System Design', icon: 'M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z' },
                    { label: '20-30 Video Reels', icon: 'M15 10l4.55-2.27A1 1 0 0121 8.61v6.78a1 1 0 01-1.45.89L15 14v2a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h8a2 2 0 012 2v2z' },
                    { label: 'Lengkap Brand Kit', icon: 'M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z' },
                    { label: 'Campaign Strategy', icon: 'M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z' }
                ],
                price: [12000000, 20000000], 
                color: 'emerald-800' 
            }
        ];

        const ADDONS = [
            { id: 'logo', name: 'Logo Design Basic', price: [300000, 1000000], cat: 'Branding' },
            { id: 'mini-brand', name: 'Mini Branding', price: [1500000, 3000000], cat: 'Branding' },
            { id: 'reels', name: 'Editing Reels/TikTok', price: [150000, 300000], unit: 'video', cat: 'Video' },
            { id: 'prod-vid', name: 'Video Produk', price: [300000, 1000000], cat: 'Video' },
            { id: 'photo', name: 'Editing Foto Produk', price: [50000, 150000], unit: 'foto', cat: 'Design' },
            { id: 'feed', name: 'Desain Feed Sosmed', price: [100000, 250000], unit: 'post', cat: 'Design' },
            { id: 'sosmed', name: 'Sosmed Management', price: [1500000, 8000000], unit: 'bulan', cat: 'Mgmt' },
            { id: 'web', name: 'Landing Page', price: [3000000, 6000000], cat: 'Web' }
        ];

  
        const COUPON_MAP = {
            'U1RVRElPMTA=': { type: 'percent', value: 0.1, label: 'Kumatkamit Friend (10%)' }, // 
            'S1VNQVRLQU1JVA==': { type: 'percent', value: 0.15, label: 'Official Partner (15%)' }, // 
            'U1BFQ0lBTDIwMjU=': { type: 'fixed', value: 1000000, label: 'New Year Special (Rp 1jt)' } // 
        };

        const AppLogo = ({ className }) => (
            <svg className={className} viewBox="0 0 1120 944" xmlns="https://www.w3.org/2000/svg" fill="currentColor">
                <path d="M657.246 479.2H1126V943.62H652.026V701.421C297.068 701.421 204.121 866.198 204.121 943.62H1.58594C1.58594 855.735 73.6535 672.573 213.549 588.01C371.401 492.592 566.418 479.2 657.246 478.153V479.2ZM474.643 242.198C830.101 242.198 923.18 77.4223 923.18 0H1126C1126 87.8849 1053.83 271.047 913.738 355.61C755.664 451.028 560.371 464.42 469.415 465.466V464.42H0V0H474.643V242.198Z"/>
            </svg>
        );

        const formatIDR = (n) => new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(n);

        const Invoice = ({ clientInfo, pkgId, selectedAddons, discount, onClose }) => {
            const pkg = PACKAGES.find(p => p.id === pkgId);
            const addons = selectedAddons.map(sa => ({ ...ADDONS.find(a => a.id === sa.id), qty: sa.qty }));
            
            const [subMin, subMax] = useMemo(() => {
                let tMin = pkg ? pkg.price[0] : 0;
                let tMax = pkg ? pkg.price[1] : 0;
                addons.forEach(a => { tMin += a.price[0] * a.qty; tMax += a.price[1] * a.qty; });
                return [tMin, tMax];
            }, [pkg, addons]);

            const discVal = useMemo(() => {
                if (!discount) return 0;
                if (discount.type === 'percent') return subMin * discount.value;
                return discount.value;
            }, [discount, subMin]);

            const [min, max] = [subMin - discVal, subMax - discVal];
            const invNum = `INV-${Math.floor(10000 + Math.random() * 90000)}`;
            const date = new Date().toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' });

            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-md p-4 no-print overflow-y-auto">
                    <div className="bg-white w-full max-w-4xl rounded-3xl shadow-2xl flex flex-col my-8 border border-emerald-100 min-h-fit overflow-hidden">
                        <div className="p-6 border-b flex justify-between items-center bg-emerald-50/30 no-print">
                            <h2 className="font-bold text-emerald-900 text-lg tracking-tight">Pratinjau Invoice</h2>
                            <div className="flex gap-2">
                                <button onClick={() => window.print()} className="px-6 py-2.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-bold transition-all flex items-center gap-2">Cetak / PDF</button>
                                <button onClick={onClose} className="px-6 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-bold transition-all">Tutup</button>
                            </div>
                        </div>
                        <div className="p-12 bg-white text-left">
                            <div className="flex flex-col md:flex-row justify-between mb-16 gap-8">
                                <div className="flex items-center gap-4">
                                    <div className="flex flex-col items-start leading-tight">
                                        <div className="flex items-center gap-3">
                                            <AppLogo className="h-9 w-auto text-emerald-800" />
                                            <span className="text-2xl font-semibold text-slate-800 tracking-tighter">Kumatkamit</span>
                                        </div>
                                        <span className="text-emerald-600 font-bold uppercase text-[9px] tracking-widest ml-[48px] -mt-1">studio</span>
                                    </div>
                                </div>
                                <div className="text-right">
                                    <h3 className="text-3xl font-bold text-slate-800 tracking-tighter mb-1">INVOICE</h3>
                                    <p className="text-emerald-600 font-bold text-sm tracking-widest">#{invNum}</p>
                                    <p className="text-slate-400 text-xs font-medium mt-1">{date}</p>
                                </div>
                            </div>
                            <div className="grid grid-cols-2 gap-12 mb-12 py-8 border-y border-slate-100">
                                <div>
                                    <p className="text-[10px] font-bold text-emerald-600 uppercase mb-4 tracking-wider">Ditagih Untuk:</p>
                                    <p className="text-xl font-bold text-slate-800 leading-tight mb-1">{clientInfo.name || 'Pelanggan'}</p>
                                    {clientInfo.company && <p className="text-sm font-semibold text-slate-600 mb-2">{clientInfo.company}</p>}
                                    <div className="space-y-1 mt-3">
                                        {clientInfo.email && <p className="text-xs text-slate-500 flex items-center gap-2"><span className="font-bold text-slate-400 uppercase text-[9px]">Email:</span> {clientInfo.email}</p>}
                                        {clientInfo.phone && <p className="text-xs text-slate-500 flex items-center gap-2"><span className="font-bold text-slate-400 uppercase text-[9px]">Phone:</span> {clientInfo.phone}</p>}
                                    </div>
                                </div>
                                <div className="text-right">
                                    <p className="text-[10px] font-bold text-emerald-600 uppercase mb-4 tracking-wider">Informasi Kontak:</p>
                                    <p className="text-sm font-bold text-slate-700">kumatkamit.studio@gmail.com</p>
                                    <p className="text-xs text-slate-400 mt-1">Jakarta, Indonesia</p>
                                    <p className="text-[10px] text-slate-400 mt-4 italic font-medium">Estimasi Penawaran Layanan</p>
                                </div>
                            </div>
                            <table className="w-full mb-12">
                                <thead>
                                    <tr className="border-b-2 border-slate-200 text-left">
                                        <th className="py-4 text-[10px] font-bold text-slate-400 uppercase tracking-wider">Deskripsi Layanan</th>
                                        <th className="py-4 text-[10px] font-bold text-slate-400 uppercase tracking-wider text-right">Qty</th>
                                        <th className="py-4 text-[10px] font-bold text-slate-400 uppercase tracking-wider text-right">Harga</th>
                                    </tr>
                                </thead>
                                <tbody className="divide-y divide-slate-50">
                                    {pkg && (
                                        <tr>
                                            <td className="py-6">
                                                <p className="font-bold text-slate-800">Paket Branding: {pkg.name}</p>
                                                <ul className="text-[10px] text-slate-400 mt-1 list-disc ml-4 space-y-0.5">
                                                    {pkg.features.map((f, i) => <li key={i}>{f.label}</li>)}
                                                </ul>
                                            </td>
                                            <td className="py-6 text-right font-medium text-slate-500">1 Paket</td>
                                            <td className="py-6 text-right font-bold text-slate-800">{formatIDR(pkg.price[0])} - {formatIDR(pkg.price[1])}</td>
                                        </tr>
                                    )}
                                    {addons.map((a, i) => (
                                        <tr key={i}>
                                            <td className="py-6">
                                                <p className="font-bold text-slate-800">{a.name}</p>
                                                <p className="text-[10px] text-slate-400 uppercase font-bold mt-1">{a.cat}</p>
                                            </td>
                                            <td className="py-6 text-right font-medium text-slate-500">{a.qty} {a.unit || 'Item'}</td>
                                            <td className="py-6 text-right font-bold text-slate-800">{formatIDR(a.price[0]*a.qty)} - {formatIDR(a.price[1]*a.qty)}</td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                            <div className="flex justify-end pt-8 border-t-4 border-emerald-800">
                                <div className="w-full max-w-sm space-y-4">
                                    <div className="flex justify-between items-center text-slate-500">
                                        <span className="text-[10px] font-bold uppercase tracking-wider">Subtotal</span>
                                        <span className="font-bold text-slate-800">{formatIDR(subMin)} - {formatIDR(subMax)}</span>
                                    </div>
                                    {discount && (
                                        <div className="flex justify-between items-center text-emerald-600">
                                            <span className="text-[10px] font-bold uppercase italic tracking-wider">Diskon ({discount.label})</span>
                                            <span className="font-bold">- {formatIDR(discVal)}</span>
                                        </div>
                                    )}
                                    <div className="flex justify-between items-center pt-6 border-t border-slate-100">
                                        <span className="text-lg font-bold text-slate-800">Total Estimasi</span>
                                        <div className="text-right">
                                            <p className="text-2xl font-bold text-emerald-700 leading-none">{formatIDR(Math.max(0, min))} - {formatIDR(Math.max(0, max))}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [clientInfo, setClientInfo] = useState({ name: '', company: '', email: '', phone: '' });
            const [pkgId, setPkgId] = useState(null);
            const [selected, setSelected] = useState([]);
            const [showInv, setShowInv] = useState(false);
            const [couponCode, setCouponCode] = useState('');
            const [appliedCoupon, setAppliedCoupon] = useState(null);
            const [couponError, setCouponError] = useState('');
            const [isChecking, setIsChecking] = useState(false);

            const totals = useMemo(() => {
                let min = 0, max = 0;
                if (pkgId) {
                    const p = PACKAGES.find(x => x.id === pkgId);
                    min += p.price[0]; max += p.price[1];
                }
                selected.forEach(s => {
                    const a = ADDONS.find(x => x.id === s.id);
                    min += a.price[0] * s.qty; max += a.price[1] * s.qty;
                });
                
                let discountVal = 0;
                if (appliedCoupon) {
                    discountVal = (appliedCoupon.type === 'percent') ? min * appliedCoupon.value : appliedCoupon.value;
                }
                return [Math.max(0, min - discountVal), Math.max(0, max - discountVal), discountVal];
            }, [pkgId, selected, appliedCoupon]);

            const toggle = (id) => setSelected(prev => prev.find(i => i.id === id) ? prev.filter(i => i.id !== id) : [...prev, { id, qty: 1 }]);
            const updQty = (id, d) => setSelected(prev => prev.map(i => i.id === id ? { ...i, qty: Math.max(1, i.qty + d) } : i));
            const handleClientChange = (e) => setClientInfo(prev => ({ ...prev, [e.target.name]: e.target.value }));

            const applyCoupon = () => {
                const code = couponCode.trim().toUpperCase();
                if (!code) return;
                setIsChecking(true);
                
                // based
                setTimeout(() => {
                    const hashed = btoa(code);
                    if (COUPON_MAP[hashed]) {
                        setAppliedCoupon(COUPON_MAP[hashed]);
                        setCouponError('');
                    } else {
                        setAppliedCoupon(null);
                        setCouponError('Kode tidak valid');
                    }
                    setIsChecking(false);
                }, 400);
            };

            const removeCoupon = () => {
                setAppliedCoupon(null);
                setCouponCode('');
                setCouponError('');
            };

            return (
                <div className="min-h-screen pb-24 lg:pb-0 bg-slate-50">
                    <nav className="sticky top-0 z-40 bg-emerald-950 text-white border-b border-emerald-800 px-8 py-5 shadow-xl">
                        <div className="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-6">
                            <div className="flex items-center gap-4">
                                <AppLogo className="h-9 w-auto text-white" />
                                <div className="flex flex-col items-start leading-none text-left">
                                    <span className="text-xl font-medium tracking-tighter text-white">Kumatkamit</span>
                                    <span className="text-emerald-400 font-bold uppercase text-[9px] tracking-widest">studio</span>
                                </div>
                            </div>
                            <div className="text-[10px] text-emerald-500 font-bold uppercase hidden md:block tracking-widest">Price Calculator v3.1</div>
                        </div>
                    </nav>

                    <main className="max-w-7xl mx-auto p-6 md:p-10 grid grid-cols-1 lg:grid-cols-12 gap-10">
                        <div className="lg:col-span-8 space-y-12">
                            {/* SECTION 01: PACKAGES */}
                            <section>
                                <div className="flex items-center gap-4 mb-10 text-left">
                                    <div className="w-10 h-10 rounded-2xl bg-emerald-700 text-white flex items-center justify-center font-bold">1</div>
                                    <h2 className="text-2xl font-bold text-slate-800 tracking-tight">Pilih Paket Utama</h2>
                                </div>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                                    {PACKAGES.map(p => {
                                        const isActive = pkgId === p.id;
                                        return (
                                            <div key={p.id} onClick={() => setPkgId(p.id)} className={`relative cursor-pointer transition-all duration-300 rounded-[2rem] border-2 p-8 flex flex-col h-full overflow-hidden text-left ${isActive ? 'package-card-active border-emerald-500' : 'border-white bg-white hover:border-emerald-100 shadow-sm'}`}>
                                                {isActive && <div className="absolute top-4 right-4 bg-emerald-500 text-white rounded-full p-1 shadow-md animate-in zoom-in duration-300"><svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="3" d="M5 13l4 4L19 7"></path></svg></div>}
                                                {p.popular && !isActive && <div className="absolute top-4 right-4 bg-emerald-500 text-white px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider">Populer</div>}
                                                <div className={`w-12 h-1 bg-${p.color} rounded-full mb-6`}></div>
                                                <h3 className="text-2xl font-bold text-slate-800 leading-tight mb-1">{p.name}</h3>
                                                <p className="text-xs text-slate-400 font-bold uppercase mb-8 tracking-wider">{p.target}</p>
                                                <div className="space-y-4 mb-10 flex-grow">
                                                    {p.features.map((f, idx) => (
                                                        <div key={idx} className="flex items-start gap-3">
                                                            <div className={`mt-0.5 flex-shrink-0 w-6 h-6 rounded-lg ${isActive ? 'bg-emerald-200 text-emerald-800' : 'bg-slate-50 text-slate-400'} flex items-center justify-center`}><svg className="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2.5" d={f.icon}></path></svg></div>
                                                            <span className={`text-sm font-semibold leading-snug ${isActive ? 'text-emerald-900' : 'text-slate-600'}`}>{f.label}</span>
                                                        </div>
                                                    ))}
                                                </div>
                                                <div className={`pt-6 border-t transition-colors ${isActive ? 'border-emerald-200' : 'border-slate-50'}`}>
                                                    <p className={`text-[10px] font-bold uppercase mb-1 tracking-wider ${isActive ? 'text-emerald-600' : 'text-slate-400'}`}>Mulai Dari</p>
                                                    <p className={`text-2xl font-bold ${isActive ? 'text-emerald-700' : 'text-slate-800'}`}>{formatIDR(p.price[0])}</p>
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            </section>

                            {/* SECTION 02: ADDONS */}
                            <section>
                                <div className="flex items-center gap-4 mb-8 text-left">
                                    <div className="w-10 h-10 rounded-2xl bg-emerald-700 text-white flex items-center justify-center font-bold">2</div>
                                    <h2 className="text-2xl font-bold text-slate-800 tracking-tight">Tambah Layanan Kustom</h2>
                                </div>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    {ADDONS.map(a => {
                                        const sel = selected.find(s => s.id === a.id);
                                        return (
                                            <div key={a.id} className={`flex items-center justify-between p-6 rounded-2xl border-2 transition-all ${sel ? 'border-emerald-500 bg-emerald-50 shadow-md' : 'border-white bg-white hover:border-emerald-100 shadow-sm'}`}>
                                                <div className="flex items-center gap-5">
                                                    <input type="checkbox" checked={!!sel} onChange={() => toggle(a.id)} className="w-6 h-6 rounded-lg text-emerald-600 cursor-pointer border-slate-200 focus:ring-emerald-500" />
                                                    <div className="text-left">
                                                        <h4 className="font-bold text-slate-800 text-sm leading-tight mb-0.5">{a.name}</h4>
                                                        <p className="text-xs font-bold text-emerald-600 tracking-tight">{formatIDR(a.price[0])}</p>
                                                    </div>
                                                </div>
                                                {sel && (
                                                    <div className="flex items-center gap-4 bg-white p-1.5 rounded-xl border border-emerald-100 shadow-sm">
                                                        <button onClick={() => updQty(a.id, -1)} className="w-8 h-8 rounded-lg bg-slate-50 hover:bg-emerald-100 text-slate-600 transition-colors font-bold">-</button>
                                                        <span className="font-bold text-slate-800 text-sm w-4 text-center">{sel.qty}</span>
                                                        <button onClick={() => updQty(a.id, 1)} className="w-8 h-8 rounded-lg bg-slate-50 hover:bg-emerald-100 text-slate-600 transition-colors font-bold">+</button>
                                                    </div>
                                                )}
                                            </div>
                                        );
                                    })}
                                </div>
                            </section>

                            {/* SECTION 03: CLIENT DETAILS */}
                            <section>
                                <div className="flex items-center gap-4 mb-8 text-left">
                                    <div className="w-10 h-10 rounded-2xl bg-emerald-700 text-white flex items-center justify-center font-bold">3</div>
                                    <h2 className="text-2xl font-bold text-slate-800 tracking-tight">Informasi Client</h2>
                                </div>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6 bg-white p-8 rounded-[2rem] border border-slate-100 shadow-sm">
                                    <div className="space-y-2 text-left">
                                        <label className="text-[10px] font-bold text-slate-400 uppercase ml-1 tracking-wider">Nama Client</label>
                                        <input name="name" value={clientInfo.name} onChange={handleClientChange} type="text" placeholder="Nama Lengkap" className="w-full px-5 py-3.5 bg-slate-50 border border-slate-200 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all font-semibold" />
                                    </div>
                                    <div className="space-y-2 text-left">
                                        <label className="text-[10px] font-bold text-slate-400 uppercase ml-1 tracking-wider">Perusahaan / Brand</label>
                                        <input name="company" value={clientInfo.company} onChange={handleClientChange} type="text" placeholder="Nama Brand" className="w-full px-5 py-3.5 bg-slate-50 border border-slate-200 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all font-semibold" />
                                    </div>
                                    <div className="space-y-2 text-left">
                                        <label className="text-[10px] font-bold text-slate-400 uppercase ml-1 tracking-wider">Alamat Email</label>
                                        <input name="email" value={clientInfo.email} onChange={handleClientChange} type="email" placeholder="client@email.com" className="w-full px-5 py-3.5 bg-slate-50 border border-slate-200 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all font-semibold" />
                                    </div>
                                    <div className="space-y-2 text-left">
                                        <label className="text-[10px] font-bold text-slate-400 uppercase ml-1 tracking-wider">WhatsApp / HP</label>
                                        <input name="phone" value={clientInfo.phone} onChange={handleClientChange} type="text" placeholder="0812-XXXX-XXXX" className="w-full px-5 py-3.5 bg-slate-50 border border-slate-200 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all font-semibold" />
                                    </div>
                                </div>
                            </section>
                        </div>

                        {/* SIDEBAR CALCULATION */}
                        <div className="lg:col-span-4">
                            <div className="sticky top-28 bg-emerald-950 text-white rounded-[2.5rem] p-10 shadow-2xl overflow-hidden group">
                                <div className="absolute -top-12 -right-12 w-48 h-48 bg-emerald-500/10 rounded-full blur-3xl group-hover:bg-emerald-500/20 transition-all"></div>
                                <h3 className="text-xs font-bold uppercase text-emerald-500 mb-10 opacity-70 text-left tracking-widest">Kalkulasi Layanan</h3>
                                <div className="space-y-6 mb-12 max-h-[35vh] overflow-y-auto custom-scrollbar pr-3">
                                    {pkgId || selected.length > 0 ? (
                                        <>
                                            {pkgId && (
                                                <div className="flex justify-between items-center text-left">
                                                    <div className="flex flex-col">
                                                        <span className="text-sm font-bold text-emerald-100">Paket {PACKAGES.find(p => p.id === pkgId).name}</span>
                                                        <span className="text-[10px] font-bold text-emerald-600 uppercase tracking-wider">Utama</span>
                                                    </div>
                                                    <span className="font-bold text-sm">{formatIDR(PACKAGES.find(p => p.id === pkgId).price[0])}</span>
                                                </div>
                                            )}
                                            {selected.map(s => {
                                                const a = ADDONS.find(x => x.id === s.id);
                                                return (
                                                    <div key={s.id} className="flex justify-between items-center text-left">
                                                        <div className="flex flex-col">
                                                            <span className="text-sm font-bold text-emerald-100 line-clamp-1">{a.name}</span>
                                                            <span className="text-[10px] font-bold text-emerald-600 uppercase tracking-wider">{s.qty}x {a.unit || 'Item'}</span>
                                                        </div>
                                                        <span className="font-bold text-sm">{formatIDR(a.price[0] * s.qty)}</span>
                                                    </div>
                                                );
                                            })}
                                        </>
                                    ) : <p className="text-sm text-emerald-700 font-semibold italic opacity-50 text-left">Silakan pilih layanan...</p>}
                                </div>

                                {/* COUPON INPUT */}
                                <div className="mb-10 text-left space-y-3">
                                    <label className="text-[10px] font-bold uppercase text-emerald-500 ml-1 tracking-wider">Coupon</label>
                                    <div className="flex gap-2">
                                        <input 
                                            type="text" 
                                            value={couponCode}
                                            onChange={(e) => setCouponCode(e.target.value)}
                                            onKeyDown={(e) => e.key === 'Enter' && applyCoupon()}
                                            placeholder="Masukkan kode..." 
                                            disabled={!!appliedCoupon || isChecking}
                                            className={`flex-grow px-4 py-3 rounded-xl bg-emerald-900/40 border ${couponError ? 'border-red-500 shake' : 'border-emerald-800'} text-xs font-bold focus:outline-none focus:border-emerald-500 transition-all uppercase placeholder:normal-case tracking-wider`}
                                        />
                                        {appliedCoupon ? (
                                            <button onClick={removeCoupon} className="px-4 py-3 bg-red-900/30 text-red-400 rounded-xl font-bold text-xs hover:bg-red-900 transition-all">Hapus</button>
                                        ) : (
                                            <button onClick={applyCoupon} disabled={isChecking || !couponCode} className="px-4 py-3 bg-emerald-700 hover:bg-emerald-600 disabled:opacity-50 text-white rounded-xl font-bold text-xs transition-all">{isChecking ? '...' : 'Cek'}</button>
                                        )}
                                    </div>
                                    {couponError && <p className="text-[10px] font-semibold text-red-400 ml-1 italic">{couponError}</p>}
                                    {appliedCoupon && <p className="text-[10px] font-bold text-emerald-400 ml-1 flex items-center gap-1"><svg className="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path fillRule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clipRule="evenodd"></path></svg> {appliedCoupon.label} Aktif</p>}
                                </div>

                                <div className="border-t border-emerald-900 pt-8 mb-10 text-left">
                                    <p className="text-[10px] font-bold text-emerald-600 uppercase mb-2 tracking-widest">Total Estimasi Terendah</p>
                                    <p className="text-4xl font-bold tracking-tighter mb-2 text-white">{formatIDR(totals[0])}</p>
                                    <div className="flex flex-col gap-1 opacity-70">
                                        <p className="text-xs text-emerald-400 font-semibold italic">Estimasi Maks: {formatIDR(totals[1])}</p>
                                        {appliedCoupon && <p className="text-xs text-emerald-300 font-bold italic">Anda Hemat: {formatIDR(totals[2])}</p>}
                                    </div>
                                </div>
                                <button onClick={() => setShowInv(true)} disabled={!pkgId && selected.length === 0} className="w-full py-5 bg-emerald-500 hover:bg-emerald-400 disabled:bg-emerald-900/50 disabled:text-emerald-800 disabled:cursor-not-allowed text-white font-bold rounded-2xl transition-all shadow-xl shadow-black/20 transform active:scale-95 text-lg uppercase tracking-widest">Buat Invoice</button>
                            </div>
                        </div>
                    </main>

                    {showInv && <Invoice clientInfo={clientInfo} pkgId={pkgId} selectedAddons={selected} discount={appliedCoupon} onClose={() => setShowInv(false)} />}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>